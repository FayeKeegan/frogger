/*
  Name: sf.desktop.product.js
   Ver: 2.8.7
  Date: 08/26/2015 12:33 PM
 Files:
	QSC.apps.product.options
	QSC.apps.product.options.option
	QSC.apps.product.options.option.checkbox
	QSC.apps.product.options.option.dropdown
	QSC.apps.product.options.option.text
	QSC.apps.product.options.optionValue
	QSC.apps.product.options.optionValue.dropdown
	QSC.util.uriBuilder
	QSC.ui.popup
	QSC.apps.widget.share
	QSC.apps.product.imageZoomPopup
	QSC.ui.carousel
	QSC.ui.button
	QSC.ui.popup.dialog
	QSC.apps.inlineNotification
	QSC.ui.popup.dialog.form
	QSC.apps.charLimitCountdown
	QSC.ui.contentPagination
	QSC.apps.storefront.ratingsReviews
	QSC.page.storefront.product

*/

QSC.util.namespace("QSC.apps.product");QSC.apps.product.options=function(a){QSC.util.loadClassConfig(this,a,{optionsList:[],availMap:{},aPriceEls:["listPrice"],aAdjPriceEls:["adjustedPrice"],aAdjPriceContainerEls:["adjustedPriceItem"],qtyElName:"quantity",submitElName:"submit",aAvailStatusEls:["prodAvailStatus"],aAvailQtyEls:["prodAvailQty"],formEl:"addToCartForm",feedback:true,createHTML:false,userPrefNoDefaultOption:false,container:null,beanPrefix:null});this.optionsList=[];this.configurationsTree={};this.invalidConfigurationObj=null;this.formEl=null;this.aPriceEls=null;this.aAdjPriceEls=null;this.aAdjPriceContainerEls=null;this.qtyEl=null;this.submitEl=null;this.aAvailStatusEls=null;this.aAvailQtyEls=null;var b=this;$(function(){b.init()})};QSC.apps.product.options.prototype.init=function(){this.initOptions();this.loadConfigurationsTree();this.retrieveFeedbackElements();this.initConfigurableOptions();this.updateTotalPrice()};QSC.apps.product.options.prototype.initOptions=function(){for(var b=0,a=this.config.optionsList.length;b<a;b++){this.initOption(this.config.optionsList[b])}this.config.optionsList=null};QSC.apps.product.options.prototype.loadConfigurationsTree=function(){var c=this.config.availMap.items;this.invalidConfigurationObj=this.config.availMap["default"];for(var g=0,b=c.length;g<b;g++){var a=c[g],h=a.key.split(","),e=this.configurationsTree;for(var f=0,d=h.length-1;f<d;f++){if(!e[h[f]]){e[h[f]]={}}e=e[h[f]]}e[h[h.length-1]]=a}this.config.availMap=null};QSC.apps.product.options.prototype.initOption=function(c){var b;switch(c.optionType){case"DROPDOWN":b=QSC.apps.product.options.option.dropdown;break;case"TEXT":b=QSC.apps.product.options.option.text;break;case"CHECKBOX":b=QSC.apps.product.options.option.checkbox;break}c.parent=this;c.index=this.optionsList.length;c.formEl=this.config.formEl;c.createHTML=this.config.createHTML;c.container=this.config.container;c.beanPrefix=this.config.beanPrefix;c.userPrefNoDefaultOption=this.config.userPrefNoDefaultOption;var a=new b(c);this.optionsList.push(a)};QSC.apps.product.options.prototype.getPriceChange=function(){var b=0,d=false;for(var c=0,a=this.optionsList.length;c<a;c++){optionPriceChange=this.optionsList[c].getPriceChange();if(optionPriceChange!=0){b+=optionPriceChange;d=true}}if(d){return b}return false};QSC.apps.product.options.prototype.updateTotalPrice=function(){if(!this.config.feedback){return}var b=this.getPriceChange();if(b===false){this.toggleAdjPrice(false);return}var a=parseFloat(this.config.price)+b;a=Math.max(a,0);this.toggleAdjPrice(true,a)};QSC.apps.product.options.prototype.toggleAdjPrice=function(b,a){if(b){QSC.util.forEach(this.aAdjPriceEls,function(c){QSC.util.setText(c,QSC.util.currency.format(a))});$(this.aAdjPriceContainerEls).show();$(this.aPriceEls).addClass("strike")}else{$(this.aAdjPriceContainerEls).hide();$(this.aPriceEls).removeClass("strike")}};QSC.apps.product.options.prototype.retrieveFeedbackElements=function(){if(!this.config.feedback){return}this.formEl=QSC.util.getElement(this.config.formEl);this.aPriceEls=QSC.util.getElements(this.config.aPriceEls);this.aAdjPriceEls=QSC.util.getElements(this.config.aAdjPriceEls);this.aAdjPriceContainerEls=QSC.util.getElements(this.config.aAdjPriceContainerEls);this.aAvailStatusEls=QSC.util.getElements(this.config.aAvailStatusEls);this.aAvailQtyEls=QSC.util.getElements(this.config.aAvailQtyEls);this.qtyEl=this.formEl[this.config.qtyElName];this.submitEl=this.formEl[this.config.submitElName]};QSC.apps.product.options.prototype.validate=function(){for(var b=0,a=this.optionsList.length;b<a;b++){if(!this.optionsList[b].validate()){return false}}return true};QSC.apps.product.options.prototype.initConfigurableOptions=function(){var c=this.getConfigurableOptions();if(c.length==0){return}var b=c[0],a=this.getCurrentConfigurationsTreeBranchOptionValueIds(c,0);b.updateOptionValuesDisplayed(a);$(this.formEl).bind("submit",this,this.updateConfigurableOnSubmit)};QSC.apps.product.options.prototype.updateConfigurableOnSubmit=function(c){var d=c.data;var b=d.getConfigurableOptions();var a=d.getCurrentConfigurationsTreeBranch(b);if(!a.key){alert("Please select a valid configuration.");return false}if(d.formEl&&d.formEl.configOptionKey){d.formEl.configOptionKey.value=a.key}return true};QSC.apps.product.options.prototype.updateConfigurableOptions=function(d){var e=this.getConfigurableOptions();var c=d.getSelectedOptionValue();if(!c){this.toggleAllItemsAfterOption(d,false);this.updateAvailability(this.invalidConfigurationObj);return}var b=e.length;for(;b>0;b--){if(e[b-1].config.optionId==d.config.optionId){b--;break}}if(b==(e.length-1)){this.toggleAllItemsAfterOption(d,true);var a=this.getCurrentConfigurationsTreeBranch(e);this.updateAvailability(a);return}var f=e[++b];var a=this.getCurrentConfigurationsTreeBranchOptionValueIds(e,b);f.updateOptionValuesDisplayed(a);f.enable()};QSC.apps.product.options.prototype.getCurrentConfigurationsTreeBranchOptionValueIds=function(d,c){var a=this.getCurrentConfigurationsTreeBranch(d,c),b=[];for(var e in a){b.push(e)}return b};QSC.apps.product.options.prototype.getCurrentConfigurationsTreeBranch=function(d,c){if(typeof(c)=="undefined"){c=d.length}var b=this.configurationsTree;for(var a=0;a<c;a++){var e=d[a].getCurrentOptionValueId();if(!b[e]){return{}}b=b[e]}return b};QSC.apps.product.options.prototype.getConfigurableOptions=function(){var d=[];for(var c=0,a=this.optionsList.length;c<a;c++){var b=this.optionsList[c];if(b.isConfigurable()){d.push(b)}}return d};QSC.apps.product.options.prototype.updateAvailability=function(a){if(!this.config.feedback){return}QSC.util.forEach(this.aAvailStatusEls,function(b){if(b){QSC.util.setText(b,a.status)}});QSC.util.forEach(this.aAvailQtyEls,function(b){if(b){if(a.quantity){QSC.util.setText(b,a.quantity);$(b).closest(".available-quantity").show()}else{$(b).closest(".available-quantity").hide()}}})};QSC.apps.product.options.prototype.toggleAllItemsAfterOption=function(f,b){var g=(b?"enable":"disable"),e=!b,h=false;for(var c=0,a=this.optionsList.length;c<a;c++){var d=this.optionsList[c];if(this.optionsList[c]==f){h=true}else{if(h){d[g]()}}}if(this.config.feedback){this.qtyEl.disabled=e;this.submitEl.disabled=e}};
QSC.util.namespace("QSC.apps.product.options");QSC.apps.product.options.option=function(a){QSC.util.loadClassConfig(this,a,{createHTML:false,container:null,mainContClass:"product-option clear-fix",labelClass:"product-option-label",optionContClass:"product-option-subcontainer",optionalContClass:"product-option-optional",inputContClass:"product-option-input",asteriskClass:"product-option-asterisk",formEl:"addToCartForm",beanPrefix:"",parent:null});this.inputEl=null;this.inputContainer=null;this.optionalEl=null;this.optionValuesList=[];this.container=null;this.mainContainer=null;this.optionsContainer=null;this.labelContainer=null;this.init()};QSC.apps.product.options.option.prototype.init=function(){this.loadOptionValues();if(this.config.createHTML){this.createHTML()}else{this.formEl=QSC.util.getElement(this.config.formEl);this.retrieveInputEl();this.retrieveOptionalEl()}this.attachEvents();this.toggleInputContainerVisibility()};QSC.apps.product.options.option.prototype.loadOptionValues=function(){if(!this.config.valueMap){return}for(var b=0,a=this.config.valueMap.length;b<a;b++){var c=new this.config.optionValueClass(this.config.valueMap[b]);this.optionValuesList.push(c)}};QSC.apps.product.options.option.prototype.retrieveInputEl=function(){this.inputEl=this.formEl["selectedOption("+this.config.optionId+")"]};QSC.apps.product.options.option.prototype.retrieveOptionalEl=function(){if(this.config.optionRequired){return}this.optionalEl=this.formEl["checkedOptional("+this.config.optionId+")"];this.inputContainer=QSC.util.getElement("checkedOptionalContainer("+this.config.optionId+")")};QSC.apps.product.options.option.prototype.attachEvents=function(){this.attachInputElChangeEvent();this.attachOptionalElChangeEvent()};QSC.apps.product.options.option.prototype.attachInputElChangeEvent=function(){var a=this;$(this.inputEl).bind("change",function(){a.inputElChangeEvent()})};QSC.apps.product.options.option.prototype.attachOptionalElChangeEvent=function(){var a=this;if(this.optionalEl){$(this.optionalEl).bind("click",function(){a.optionalElChangeEvent()})}};QSC.apps.product.options.option.prototype.inputElChangeEvent=function(){if(this.config.configurable){this.config.parent.updateConfigurableOptions(this)}this.config.parent.updateTotalPrice()};QSC.apps.product.options.option.prototype.optionalElChangeEvent=function(){this.toggleInputContainerVisibility();this.config.parent.updateTotalPrice()};QSC.apps.product.options.option.prototype.toggleInputContainerVisibility=function(){if(this.config.optionRequired){return}if(this.optionalEl.checked){this.inputContainer.style.display="";this.inputEl.focus();this.onInputContainerShow()}else{this.inputContainer.style.display="none";this.onInputContainerHide()}};QSC.apps.product.options.option.prototype.onInputContainerShow=function(){};QSC.apps.product.options.option.prototype.onInputContainerHide=function(){};QSC.apps.product.options.option.prototype.getPriceChange=function(){return 0};QSC.apps.product.options.option.prototype.getOptionalElPriceChange=function(){if(this.optionalEl&&this.optionalEl.checked){return parseFloat(this.config.optionPriceInc)}return 0};QSC.apps.product.options.option.prototype.isConfigurable=function(){return this.config.configurable};QSC.apps.product.options.option.prototype.enable=function(){this.enableInputEl();if(!this.config.optionRequired){this.enableOptionalEl()}};QSC.apps.product.options.option.prototype.disable=function(){this.disableInputEl();if(!this.config.optionRequired){this.disableOptionalEl()}};QSC.apps.product.options.option.prototype.enableInputEl=function(){this.inputEl.disabled=false};QSC.apps.product.options.option.prototype.disableInputEl=function(){this.inputEl.disabled=true};QSC.apps.product.options.option.prototype.enableOptionalEl=function(){this.optionalEl.disabled=false};QSC.apps.product.options.option.prototype.disableOptionalEl=function(){this.optionalEl.disabled=true};QSC.apps.product.options.option.prototype.toggleMediaPreview=function(){var a=this.config.useCode;if(!a){return}this.selectMediaPreview(a)};QSC.apps.product.options.option.prototype.selectMediaPreview=function(b){var a=document.getElementById("useCode_"+b);if(!a){return}a.onclick()};QSC.apps.product.options.option.prototype.createHTML=function(){this.container=this.config.container;this.mainContainer=document.createElement("DIV");this.mainContainer.className=this.config.mainContClass;var a=document.createElement("INPUT");a.type="hidden";a.name=this.getBeanPrefix()+"optionId";a.value=this.config.optionId;this.mainContainer.appendChild(a);this.createLabel();this.optionsContainer=document.createElement("DIV");this.optionsContainer.className=this.config.optionContClass;this.inputContainer=document.createElement("DIV");this.inputContainer.className=this.config.inputContClass;if(!this.config.optionRequired){this.createOptionalEl()}this.createAsterisk();this.createInputEl();this.optionsContainer.appendChild(this.inputContainer);this.mainContainer.appendChild(this.optionsContainer);this.container.appendChild(this.mainContainer)};QSC.apps.product.options.option.prototype.createAsterisk=function(){var a=document.createElement("SPAN");a.className=this.config.asteriskClass;QSC.util.setText(a,"*");if(this.config.optionRequired){this.labelContainer.appendChild(a)}else{this.inputContainer.appendChild(a)}};QSC.apps.product.options.option.prototype.getBeanPrefix=function(){return this.config.beanPrefix+"options["+this.config.index+"]."};QSC.apps.product.options.option.prototype.createLabel=function(){var a=document.createElement("DIV");a.className=this.config.labelClass;QSC.util.setText(a,this.config.optionLabel);this.labelContainer=a;this.mainContainer.appendChild(this.labelContainer)};QSC.apps.product.options.option.prototype.createOptionalEl=function(){var b=document.createElement("DIV");b.className=this.config.optionalContClass;var a=document.createElement("INPUT");a.type="checkbox";a.name=this.getBeanPrefix()+"checkedOptional";a.value="yes";if(this.config.checkedOptional){a.checked=a.defaultChecked=true}var c=document.createElement("SPAN");QSC.util.setText(c,(this.config.optionPriceInc!=0?this.config.optionPriceIncLabel:""));b.appendChild(a);b.appendChild(c);this.optionalEl=a;this.optionsContainer.appendChild(b)};QSC.apps.product.options.option.prototype.createInputEl=function(){};QSC.apps.product.options.option.prototype.validate=function(){if(!this.config.optionRequired&&!this.optionalEl.checked){return true}if(!this.validateInputEl()){return false}return true};QSC.apps.product.options.option.prototype.validateInputEl=function(){};
QSC.util.namespace("QSC.apps.product.options.option");QSC.apps.product.options.option.checkbox=function(a){a.optionRequired=true;QSC.apps.product.options.option.checkbox.superclass.constructor.call(this,a)};QSC.util.extend(QSC.apps.product.options.option.checkbox,QSC.apps.product.options.option);QSC.apps.product.options.option.checkbox.prototype.createInputEl=function(){var a=document.createElement("INPUT");a.type="checkbox";a.name=this.getBeanPrefix()+"checkedOptional";a.value="yes";var b=document.createElement("SPAN");QSC.util.setText(b,(this.config.optionPriceInc!=0?this.config.optionPriceIncLabel:""));this.inputContainer.appendChild(a);this.inputContainer.appendChild(b);this.inputEl=a};QSC.apps.product.options.option.checkbox.prototype.attachInputElChangeEvent=function(){var a=this;$(this.inputEl).bind("click",function(){a.inputElChangeEvent()})};QSC.apps.product.options.option.checkbox.prototype.retrieveInputEl=function(){this.inputEl=this.formEl["checkedOptional("+this.config.optionId+")"]};QSC.apps.product.options.option.checkbox.prototype.getPriceChange=function(){if(this.inputEl.checked){return parseFloat(this.config.optionPriceInc)}return 0};QSC.apps.product.options.option.checkbox.prototype.validateInputEl=function(){};
QSC.util.namespace("QSC.apps.product.options.option");QSC.apps.product.options.option.dropdown=function(a){QSC.util.loadClassConfig(this,a,{optionValueClass:QSC.apps.product.options.optionValue.dropdown});QSC.apps.product.options.option.dropdown.superclass.constructor.call(this,a)};QSC.util.extend(QSC.apps.product.options.option.dropdown,QSC.apps.product.options.option);QSC.apps.product.options.option.dropdown.prototype.inputElChangeEvent=function(){this.toggleMediaPreview();QSC.apps.product.options.option.dropdown.superclass.inputElChangeEvent.call(this)};QSC.apps.product.options.option.dropdown.prototype.toggleMediaPreview=function(){var a=this.getSelectedOptionValue();if(!a){return}var b=a.getMediaUseCode();if(!b){return}this.selectMediaPreview(b)};QSC.apps.product.options.option.dropdown.prototype.onInputContainerShow=function(){this.toggleMediaPreview()};QSC.apps.product.options.option.dropdown.prototype.getPriceChange=function(){var a=0;if(this.config.optionRequired||this.optionalEl.checked){var b=this.getSelectedOptionValue();if(b){a+=b.getPriceChange()}}a+=this.getOptionalElPriceChange();return a};QSC.apps.product.options.option.dropdown.prototype.getSelectedOptionValue=function(){var d=this.inputEl.value;for(var b=0,a=this.optionValuesList.length;b<a;b++){var c=this.optionValuesList[b];if(d==c.getValue()){return c}}return null};QSC.apps.product.options.option.dropdown.prototype.getCurrentOptionValueId=function(){var a=this.getSelectedOptionValue();if(a==null){return null}return a.getId()};QSC.apps.product.options.option.dropdown.prototype.updateOptionValuesDisplayed=function(d){var g=this.getCurrentOptionValueId();this.clearOptionValues();this.createDefaultOption();for(var f=0,b=this.optionValuesList.length;f<b;f++){var a=this.optionValuesList[f],h=a.getId();for(var e=0,c=d.length;e<c;e++){if(h==d[e]){this.drawOptionValue(a,(g==h));break}}}this.config.parent.updateConfigurableOptions(this)};QSC.apps.product.options.option.dropdown.prototype.clearOptionValues=function(){for(var b=0,a=this.inputEl.options.length;b<a;b++){this.inputEl.remove(0)}};QSC.apps.product.options.option.dropdown.prototype.drawOptionValue=function(a,b){this.inputEl.options[this.inputEl.options.length]=a.createHTML(b)};QSC.apps.product.options.option.dropdown.prototype.disableInputEl=function(){this.inputEl.selectedIndex=0;this.inputEl.disabled=true};QSC.apps.product.options.option.dropdown.prototype.createDefaultOption=function(){if(!this.config.configurable&&this.config.userPrefNoDefaultOption){return}this.inputEl.options[this.inputEl.options.length]=new Option("Select","")};QSC.apps.product.options.option.dropdown.prototype.createInputEl=function(){var c=document.createElement("SELECT");c.name=this.getBeanPrefix()+"value";this.inputEl=c;this.createDefaultOption();for(var a=0;a<this.optionValuesList.length;a++){var b=this.config.value==this.optionValuesList[a].getValue();c.options[c.options.length]=this.optionValuesList[a].createHTML(b)}this.inputContainer.appendChild(c)};QSC.apps.product.options.option.dropdown.prototype.validateInputEl=function(){if(this.getSelectedOptionValue()==null){this.inputEl.focus();alert('Please select a valid product Option for "'+this.config.optionLabel+'"');return false}return true};QSC.apps.product.options.option.dropdown.prototype.createAsterisk=function(){if(!this.config.configurable&&this.config.userPrefNoDefaultOption){return}QSC.apps.product.options.option.dropdown.superclass.createAsterisk.call(this)};
QSC.util.namespace("QSC.apps.product.options.option");QSC.apps.product.options.option.text=function(a){QSC.apps.product.options.option.text.superclass.constructor.call(this,a)};QSC.util.extend(QSC.apps.product.options.option.text,QSC.apps.product.options.option);QSC.apps.product.options.option.text.prototype.createInputEl=function(){var a=document.createElement("TEXTAREA");a.name=this.getBeanPrefix()+"value";a.value=this.config.value||"";a.rows="3";a.cols="20";this.inputContainer.appendChild(a);this.inputEl=a};QSC.apps.product.options.option.text.prototype.attachEvents=function(){this.attachInputElFocusEvent();QSC.apps.product.options.option.text.superclass.attachEvents.call(this)};QSC.apps.product.options.option.text.prototype.attachInputElFocusEvent=function(){var a=this;$(this.inputEl).bind("focus",function(){a.toggleMediaPreview()})};QSC.apps.product.options.option.text.prototype.getPriceChange=function(){var a=0;a+=this.getOptionalElPriceChange();return a};QSC.apps.product.options.option.text.prototype.validateInputEl=function(){if(this.inputEl.value.length<this.config.minChars||this.inputEl.value.length>this.config.maxChars){this.inputEl.focus();alert("Please enter a value between "+this.config.minChars+" and "+this.config.maxChars+' characters for "'+this.config.optionLabel+'"');return false}return true};
QSC.util.namespace("QSC.apps.product.options");QSC.apps.product.options.optionValue=QSC.apps.product.options.optionValue||{};QSC.apps.product.options.optionValue=function(a){QSC.util.loadClassConfig(this,a,{id:null,value:null,priceAdj:null,text:null,useCode:null})};QSC.apps.product.options.optionValue.prototype.getValue=function(){return this.config.value};QSC.apps.product.options.optionValue.prototype.getId=function(){return this.config.id};QSC.apps.product.options.optionValue.prototype.getPriceChange=function(){return parseFloat(this.config.priceAdj)};QSC.apps.product.options.optionValue.prototype.getMediaUseCode=function(){return this.config.useCode};
QSC.util.namespace("QSC.apps.product.options.optionValue");QSC.apps.product.options.optionValue.dropdown=function(a){QSC.apps.product.options.optionValue.dropdown.superclass.constructor.call(this,a)};QSC.util.extend(QSC.apps.product.options.optionValue.dropdown,QSC.apps.product.options.optionValue);QSC.apps.product.options.optionValue.dropdown.prototype.createHTML=function(b){var a=document.createElement("OPTION");a.text=this.config.text;a.value=this.config.value;if(b==true){a.selected=true}return a};
QSC.util.uriBuilder=function(a){QSC.util.loadClassConfig(this,a,{baseUri:"",mParams:{},noCache:false});this.sPath=this.config.baseUri;this.sHash="";this.sSearch="";this.mParams={};if(this.sPath.indexOf("#")>-1){this.sHash=this.sPath.substring(this.sPath.indexOf("#"));this.sPath=this.sPath.substring(0,this.sPath.indexOf("#"))}if(this.sPath.indexOf("?")>-1){this.sSearch=this.sPath.substring(this.sPath.indexOf("?"));this.sPath=this.sPath.substring(0,this.sPath.indexOf("?"))}this.setSearch(this.sSearch);for(var b in this.config.mParams){this.setParam(b,this.config.mParams[b])}if(this.config.noCache){this.setParam("_",(new Date()).getTime())}};QSC.util.uriBuilder.prototype.setSearch=function(b){var a=/[?&]([^=]*)=([^&#]*)/g,c;while((c=a.exec(b))!=null){this.setParam(c[1],c[2])}};QSC.util.uriBuilder.prototype.setParams=function(b){for(var a in b){this.setParam(a,b[a])}};QSC.util.uriBuilder.prototype.setParam=function(a,b){this.mParams[a]=b};QSC.util.uriBuilder.prototype.setPath=function(a){this.sPath=a};QSC.util.uriBuilder.prototype.getUri=function(){return[this.sPath,this.getQueryString(),this.sHash].join("")};QSC.util.uriBuilder.prototype.getQueryString=function(){var b=[];for(var a in this.mParams){b.push(a+"="+this.mParams[a])}return"?"+b.join("&")};
var QSC=QSC||{};QSC.ui=QSC.ui||{};QSC.ui.popup=function(a){QSC.util.loadClassConfig(this,a,{modalEl:"qscPopup",className:"",autoOpen:true,autoHide:false,allowPageHeader:false,pageHeaderId:"header",closeOnMaskClick:false,onOpen:function(){},onBeforeOpen:function(){},onClose:function(){},onBeforeClose:function(){},widthPercent:null,heightPercent:null,zIndexes:{modal:101,mask:100,pageHeader:99}});this.shown=false;this.maskEl=null;this.modalEl=null;this.maskRendered=false;this.zIndexModal=null;this.zIndexMask=null;this.zIndexPageHeader=null;var b=this;this.resizeListener=function(){b.onWindowResize()};$(function(){b.init()})};QSC.ui.popup.visibleInstances=[];QSC.ui.popup.prototype.init=function(){var a=this;this.render();if(!this.config.autoOpen){return}this.open()};QSC.ui.popup.prototype.render=function(){this.initMask();this.initModal()};QSC.ui.popup.prototype.initMask=function(){var b=this;if(!this.maskRendered){this.maskRendered=true;var a=document.getElementById("popup_mask");if(a){this.maskEl=a}else{this.createMaskEl()}if(this.config.closeOnMaskClick){QSC.util.events.addEvent(this.getMaskEl(),"click",function(){if(b.isMostVisiblePopup()){b.hide()}})}}};QSC.ui.popup.prototype.initModal=function(){this.modalEl=document.createElement("DIV");this.modalEl.appendChild(QSC.util.getElement(this.config.modalEl));QSC.util.addClass(this.modalEl,"popup-modal");QSC.util.addClass(this.modalEl,this.config.className);this.modalEl.firstChild.style.display="block";this.modalEl.firstChild.style.visibility="visible";document.body.appendChild(this.modalEl)};QSC.ui.popup.prototype.createMaskEl=function(){var a=this;this.maskEl=document.createElement("div");this.maskEl.id="popup_mask";this.maskEl.className="popup-mask";document.body.appendChild(this.maskEl)};QSC.ui.popup.prototype.open=function(){if(this.config.onBeforeOpen.call(this)===false||this.shown){return}this.determineZIndexes();this.addToGlobalArray();this.showMask();this.showModal();this.adjustPageHeader(this.zIndexPageHeader);this.attachListeners();this.shown=true;this.config.onOpen.call(this)};QSC.ui.popup.prototype.determineZIndexes=function(){if(QSC.ui.popup.visibleInstances.length){var a=QSC.ui.popup.visibleInstances[QSC.ui.popup.visibleInstances.length-1];this.zIndexPageHeader=a.zIndexModal+10;this.zIndexMask=a.zIndexModal+11;this.zIndexModal=a.zIndexModal+12}else{this.zIndexModal=this.config.zIndexes.modal;this.zIndexMask=this.config.zIndexes.mask;this.zIndexPageHeader=this.config.zIndexes.pageHeader}if(this.config.allowPageHeader){this.zIndexModal-=3;this.zIndexMask-=3}};QSC.ui.popup.prototype.addToGlobalArray=function(){QSC.ui.popup.visibleInstances.push(this);this.onGlobalArrayUpdate()};QSC.ui.popup.prototype.onGlobalArrayUpdate=function(c){var d=QSC.ui.popup.visibleInstances;if(c){QSC.util.removeClass(this.modalEl,"most-visible")}for(var b=0,a=d.length;b<a;b++){QSC.util.removeClass(d[b].modalEl,"most-visible")}if(d.length){QSC.util.addClass(d[d.length-1].modalEl,"most-visible");QSC.util.addClass(document.body,"qsc-popup-active")}else{QSC.util.removeClass(document.body,"qsc-popup-active")}};QSC.ui.popup.prototype.showMask=function(){this.maskEl.style.display="block";this.maskEl.style.zIndex=this.zIndexMask};QSC.ui.popup.prototype.showModal=function(){this.modalEl.style.display="block";this.modalEl.style.zIndex=this.zIndexModal;this.positionContent()};QSC.ui.popup.prototype.adjustPageHeader=function(b){var a=this.getPageHeader();if(!a){return}window.setTimeout(function(){a.style.zIndex=b},0)};QSC.ui.popup.prototype.getPageHeader=function(){return document.getElementById(this.config.pageHeaderId)};QSC.ui.popup.prototype.attachListeners=function(){$(window).bind("resize.QSC.ui.popup",this.resizeListener)};QSC.ui.popup.prototype.onWindowResize=function(){this.positionContent()};QSC.ui.popup.prototype.hide=function(){if(!this.shown){return}var a=this.isMostVisiblePopup();this.removeFromGlobalArray();if(a){this.hideMask()}this.hideModal();this.detachListeners();this.shown=false};QSC.ui.popup.prototype.isMostVisiblePopup=function(){return(QSC.ui.popup.visibleInstances[QSC.ui.popup.visibleInstances.length-1]==this)};QSC.ui.popup.prototype.removeFromGlobalArray=function(){QSC.util.array.remove(QSC.ui.popup.visibleInstances,this);this.onGlobalArrayUpdate(true)};QSC.ui.popup.prototype.hideMask=function(){if(!QSC.ui.popup.visibleInstances.length){this.maskEl.style.display="none";this.adjustPageHeader(this.config.zIndexes.pageHeader)}else{var a=QSC.ui.popup.visibleInstances[QSC.ui.popup.visibleInstances.length-1];this.maskEl.style.zIndex=a.zIndexMask;this.adjustPageHeader(a.zIndexPageHeader)}};QSC.ui.popup.prototype.hideModal=function(){this.modalEl.style.display="none"};QSC.ui.popup.prototype.detachListeners=function(){$(window).unbind("resize.QSC.ui.popup",this.resizeListener)};QSC.ui.popup.prototype.positionContent=function(){var h=this.modalEl.firstChild,b=false,i=false,c=10,d=10;if(this.config.widthPercent){this.modalEl.style.width=this.config.widthPercent+"%";h.style.width="100%";c=0;b=true}else{this.modalEl.style.width="auto"}if(this.config.heightPercent){this.modalEl.style.height=this.config.heightPercent+"%";h.style.height="100%";d=0;i=true}else{this.modalEl.style.height="auto"}this.modalEl.style.overflow="visible";var k=$(this.modalEl),e=k.width(),j=k.height(),g=$(window),f=g.width(),a=g.height();if(!b&&e>f){k.width(f-(c*2));this.modalEl.style.overflow="auto"}if(!i&&j>a){k.height(a-(d*2));this.modalEl.style.overflow="auto"}if(k.css("position")==="fixed"){this.modalEl.style.left=Math.max(c,parseInt(f/2-e/2))+"px";this.modalEl.style.top=Math.max(d,parseInt(a/2-j/2))+"px"}};QSC.ui.popup.prototype.getModalEl=function(){return this.modalEl};QSC.ui.popup.prototype.getMaskEl=function(){return this.maskEl};QSC.ui.popup.prototype.isShown=function(){return this.shown};QSC.ui.popup.prototype.destroy=function(){this.hide();this.modalEl.parentNode.removeChild(this.modalEl);delete this.maskEl;delete this.modalEl;delete this.config};QSC.ui.popup.prototype.close=function(){if(this.config.onBeforeClose){if(this.config.onBeforeClose.call(this)===false){return}}if(this.config.onClose){this.config.onClose.call(this)}if(this.config.autoHide){this.hide()}else{this.destroy()}};
QSC.util.namespace("QSC.apps.widget");QSC.apps.widget.share=function(a){QSC.util.loadClassConfig(this,a,{popupTitle:"Share this page",shareTitle:document.title,shareURL:document.location.href,shareSummary:$("meta[name=description]").attr("content")||document.title,priPlugins:["facebook","twitter","email","delicious","digg","stumbleupon","myspace"],secPlugins:["twitterLarge","facebookLarge"],pluginsConfig:{}});this.oPlugins={};this.oPopup=null;this.zeroClipboardClip=null;var b=this;$(function(){b.init()})};QSC.apps.widget.share.instance=null;QSC.apps.widget.share.launch=function(a){var b=QSC.apps.widget.share.instance;if(!b){QSC.apps.widget.share.instance=new QSC.apps.widget.share(a)}else{b.show()}};QSC.apps.widget.share.attach=function(b,a){var c=document.getElementById(b);if(!c){return}QSC.util.events.addEvent(c,"click",function(){QSC.apps.widget.share.launch(a);return false})};QSC.apps.widget.share.prototype.init=function(){this.initPlugins(this.config.priPlugins);this.initPlugins(this.config.secPlugins);this.render();this.show()};QSC.apps.widget.share.prototype.render=function(){var g=this;var b=this.popupContainerEl=document.createElement("div");b.className="share-widget";var d=document.createElement("div");d.className="close-button";QSC.util.events.addEvent(d,"click",function(){g.hide()});b.appendChild(d);var f=document.createElement("div");f.className="popup-title";f.innerHTML="Share this page";b.appendChild(f);if(this.config.priPlugins.length){var a=document.createElement("div");a.className="plugins-pri clearfix";this.renderPlugins(a,this.config.priPlugins);b.appendChild(a)}if(this.config.secPlugins.length){var e=document.createElement("div");e.className="plugins-sec clearfix";this.renderPlugins(e,this.config.secPlugins);b.appendChild(e)}var c=QSC.util.getTopMostZIndex();this.oPopup=new QSC.ui.popup({modalEl:b,autoOpen:false,autoHide:true,closeOnMaskClick:true,zIndexes:{modal:c+3,mask:c+2,pageHeader:c+1}})};QSC.apps.widget.share.prototype.renderPlugins=function(e,c){for(var d=0,a=c.length;d<a;d++){var b=c[d],f=this.oPlugins[b];f.render(e)}};QSC.apps.widget.share.prototype.show=function(){if(this.oPopup.isShown()){return}if(!this.escKeyFn){this.initEscKeyFn()}QSC.util.events.addEvent(window,"keydown",this.escKeyFn);this.oPopup.open()};QSC.apps.widget.share.prototype.hide=function(){if(!this.oPopup.isShown()){return}QSC.util.events.removeEvent(window,"keydown",this.escKeyFn);this.oPopup.close()};QSC.apps.widget.share.prototype.initEscKeyFn=function(){var a=this;this.escKeyFn=function(b){if(b.keyCode!=27){return}a.hide()}};QSC.apps.widget.share.prototype.initPlugins=function(c){for(var d=0,a=c.length;d<a;d++){var b=c[d];if(this.oPlugins[b]){continue}var f={};QSC.util.loadClassConfig(f,this.config.pluginsConfig[b],{title:this.config.shareTitle,url:this.config.shareURL,summary:this.config.shareSummary});var e=QSC.apps.widget.share.plugin[b];if(!e){throw ("Plugin QSC.apps.widget.share.plugin."+b+" does not exist.");continue}this.oPlugins[b]=new e(f.config)}};QSC.apps.widget.share.plugin=function(a){QSC.util.loadClassConfig(this,a,{name:"",icon:{src:"no-image.gif",width:0,height:0}});var b=this;$(function(){b.init()})};QSC.apps.widget.share.plugin.prototype.init=function(){};QSC.apps.widget.share.plugin.prototype.render=function(b){var e=this;var c=this.containerEl=document.createElement("div");c.className="plugin plugin-inst-"+this.config.className;c.setAttribute("tabindex","0");var a=document.createElement("div");a.className="plugin-icon";c.appendChild(a);var d=document.createElement("div");d.className="plugin-text";d.innerHTML=this.config.name;c.appendChild(d);QSC.util.events.addEvent(c,"click",function(){e.onClick()});b.appendChild(c)};QSC.apps.widget.share.plugin.prototype.onClick=function(){};QSC.apps.widget.share.plugin.prototype.openWindow=function(a,b,c){window.open(a,"","width="+b+",height="+c+",scrollbars=yes,location=no,directories=no,status=no,menubar=no,toolbar=no,dependent=no")};QSC.apps.widget.share.plugin.facebook=function(a){QSC.util.loadClassConfig(this,a,{name:"Facebook",className:"facebook"});QSC.apps.widget.share.plugin.facebook.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.widget.share.plugin.facebook,QSC.apps.widget.share.plugin);QSC.apps.widget.share.plugin.facebook.prototype.onClick=function(){var a=new QSC.util.uriBuilder({baseUri:this.config.url,noCache:true});var b="http://www.facebook.com/sharer.php?u="+escape(a.getUri());this.openWindow(b,600,300)};QSC.apps.widget.share.plugin.twitter=function(a){QSC.util.loadClassConfig(this,a,{name:"Twitter",className:"twitter"});QSC.apps.widget.share.plugin.twitter.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.widget.share.plugin.twitter,QSC.apps.widget.share.plugin);QSC.apps.widget.share.plugin.twitter.prototype.onClick=function(){var a="http://twitter.com/share?url="+escape(this.config.url)+"&text="+escape(this.config.title)+(this.config.via?"&via="+escape(this.config.via):"");this.openWindow(a,500,400)};QSC.apps.widget.share.plugin.email=function(a){QSC.util.loadClassConfig(this,a,{name:"Email",className:"email"});QSC.apps.widget.share.plugin.email.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.widget.share.plugin.email,QSC.apps.widget.share.plugin);QSC.apps.widget.share.plugin.email.prototype.onClick=function(){var a="mailto:?subject="+escape(this.config.title)+"&body="+escape(this.config.title)+"%0D%0A"+escape(this.config.url);window.location.href=a};QSC.apps.widget.share.plugin.delicious=function(a){QSC.util.loadClassConfig(this,a,{name:"Delicious",className:"delicious"});QSC.apps.widget.share.plugin.delicious.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.widget.share.plugin.delicious,QSC.apps.widget.share.plugin);QSC.apps.widget.share.plugin.delicious.prototype.onClick=function(){var a="http://delicious.com/save?noui=yes&share=yes&jump=close&time="+new Date().getTime()+"&recipients=&url="+escape(this.config.url)+"&title="+escape(this.config.title)+"&notes="+escape(this.config.summary);this.openWindow(a,500,500)};QSC.apps.widget.share.plugin.digg=function(a){QSC.util.loadClassConfig(this,a,{name:"Digg",className:"digg"});QSC.apps.widget.share.plugin.digg.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.widget.share.plugin.digg,QSC.apps.widget.share.plugin);QSC.apps.widget.share.plugin.digg.prototype.onClick=function(){var a="http://digg.com/submit?url="+escape(this.config.url)+"&title="+escape(this.config.title)+"&bodytext="+escape(this.config.summary);this.openWindow(a,1024,768)};QSC.apps.widget.share.plugin.stumbleupon=function(a){QSC.util.loadClassConfig(this,a,{name:"Stumble",className:"stumble"});QSC.apps.widget.share.plugin.stumbleupon.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.widget.share.plugin.stumbleupon,QSC.apps.widget.share.plugin);QSC.apps.widget.share.plugin.stumbleupon.prototype.onClick=function(){var a="http://www.stumbleupon.com/submit?url="+escape(this.config.url)+"&title="+escape(this.config.title);this.openWindow(a,750,500)};QSC.apps.widget.share.plugin.myspace=function(a){QSC.util.loadClassConfig(this,a,{name:"MySpace",className:"myspace"});QSC.apps.widget.share.plugin.myspace.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.widget.share.plugin.myspace,QSC.apps.widget.share.plugin);QSC.apps.widget.share.plugin.myspace.prototype.onClick=function(){var a="http://www.myspace.com/index.cfm?fuseaction=postto&u="+escape(this.config.url)+"&t="+escape(this.config.title)+"&c="+escape('<a href="'+escape(this.config.url)+'">'+this.config.title+"</a>");this.openWindow(a,1024,768)};QSC.apps.widget.share.plugin.facebookLarge=function(a){QSC.util.loadClassConfig(this,a,{className:"facebookLarge"});QSC.apps.widget.share.plugin.facebookLarge.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.widget.share.plugin.facebookLarge,QSC.apps.widget.share.plugin);QSC.apps.widget.share.plugin.facebookLarge.prototype.render=function(b){var c=this.containerEl=document.createElement("div");c.className="plugin plugin-inst-"+this.config.className;var a=document.createElement("iframe");a.setAttribute("scrolling","no");a.setAttribute("frameBorder","0");a.setAttribute("allowTransparency","true");a.src="http://www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2F"+escape(this.config.fan)+"&amp;width=250&amp;colorscheme=light&amp;show_faces=false&amp;stream=false&amp;header=false&amp;height=62";c.appendChild(a);b.appendChild(c)};QSC.apps.widget.share.plugin.twitterLarge=function(a){QSC.util.loadClassConfig(this,a,{className:"twitterLarge"});QSC.apps.widget.share.plugin.twitterLarge.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.widget.share.plugin.twitterLarge,QSC.apps.widget.share.plugin);QSC.apps.widget.share.plugin.twitterLarge.prototype.render=function(f){var g=this.containerEl=document.createElement("div");g.className="plugin plugin-inst-"+this.config.className;var b=document.createElement("div");b.className="plugin-left-pane";var e=document.createElement("div");e.className="plugin-profile-img";e.style.backgroundImage="url(http://api.twitter.com/1/users/profile_image/"+escape(this.config.follow)+".json?size=normal)";b.appendChild(e);var d=document.createElement("div");d.className="plugin-right-pane";var a=document.createElement("div");a.className="plugin-text";QSC.util.setText(a,this.config.follow);d.appendChild(a);var h=document.createElement("div");h.className="plugin-icon";d.appendChild(h);var c=document.createElement("a");c.target="_blank";c.href="http://twitter.com/"+escape(this.config.follow);c.innerHTML="Follow us on Twitter";d.appendChild(c);g.appendChild(b);g.appendChild(d);f.appendChild(g)};
QSC.util.namespace("QSC.apps.product");QSC.apps.product.imageZoomPopup=function(a){var b=QSC.util.getTopMostZIndex();QSC.util.loadClassConfig(this,a,{images:[],closeOnMaskClick:true,autoHide:true,zIndexes:{modal:b+3,mask:b+2,pageHeader:b+1}});this.images=this.config.images;this.largeImage=null;this.unzoomdexImage=null;this.previewPaneWidth=880;this.previewPaneHeight=495;this.currentImageWidth=0;this.currentImageHeight=0;this.currentTooTall=false;this.currentTooWide=false;this.currentImageIndex=null;this.bottomRow=null;QSC.apps.product.imageZoomPopup.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.apps.product.imageZoomPopup,QSC.ui.popup);QSC.apps.product.imageZoomPopup.prototype.cycleToImage=function(b){var h=this;if(b<0){b=this.images.length-1}else{if(b>=this.images.length){b=0}}this.currentImageZooms=false;var f="center";var d="center";this.unzoomedImage.style.display="none";this.unzoomedImage.style.marginTop="0px";this.largeImage.style.visibility="visible";this.unzoomedImage.style.width="auto";this.unzoomedImage.style.height="auto";this.unzoomedImage.src=this.images[b].preview.url;this.largeImage.style.backgroundImage='url("'+this.escapeUrl(this.images[b].fullsize.url)+'")';this.currentTooWide=false;this.currentTooTall=false;if(this.images[b].fullsize.height>=this.previewPaneHeight){this.currentTooTall=true;this.unzoomedImage.style.height=this.previewPaneHeight+"px";d="0px";this.largeImage.style.visibility="hidden";this.unzoomedImage.style.visibility="visible";this.unzoomedImage.style.display=""}if(this.images[b].fullsize.width>=this.previewPaneWidth){this.currentTooWide=true;f="0px";this.largeImage.style.visibility="hidden";this.unzoomedImage.style.visibility="visible";if(!this.currentTooTall){this.unzoomedImage.style.marginTop=(this.previewPaneHeight-(this.previewPaneWidth*this.images[b].preview.height)/this.images[b].preview.width)/2+"px";this.unzoomedImage.style.width=this.previewPaneWidth+"px"}else{var g=(this.images[b].fullsize.width-this.previewPaneWidth)/this.images[b].fullsize.width;var c=(this.images[b].fullsize.height-this.previewPaneHeight)/this.images[b].fullsize.height;if(g>c){var e=parseInt((this.previewPaneWidth*this.images[b].fullsize.height)/this.images[b].fullsize.width);this.unzoomedImage.style.height=e+"px";this.unzoomedImage.style.width=this.previewPaneWidth+"px";this.unzoomedImage.style.marginTop=(this.previewPaneHeight-e)/2+"px"}else{var a=parseInt((this.previewPaneHeight*this.images[b].fullsize.width)/this.images[b].fullsize.height);this.unzoomedImage.style.width=a+"px";this.unzoomedImage.style.height=this.previewPaneHeight+"px"}}this.unzoomedImage.style.display=""}if(this.currentTooTall||this.currentTooWide){this.unzoomedImage.style.cursor="url("+QSC.util.staticTools.imageUrl("images/common/zoom-in.cur")+"),default";this.largeImage.style.cursor="url("+QSC.util.staticTools.imageUrl("images/common/zoom-out.cur")+"),default"}else{this.unzoomedImage.style.cursor="default";this.largeImage.style.cursor="default"}this.largeImage.style.backgroundPosition=f+" "+d;this.currentImageIndex=b;this.highlightSelectedImage();this.loadLargeImage()};QSC.apps.product.imageZoomPopup.prototype.highlightSelectedImage=function(){for(var a=0,b=this.images.length;a<b;a++){QSC.util.removeClass(this.bottomRow.childNodes[a],"selected-image")}QSC.util.addClass(this.bottomRow.childNodes[this.currentImageIndex],"selected-image")};QSC.apps.product.imageZoomPopup.prototype.loadLargeImage=function(){var a=new Image();var b=this;a.onload=function(){b.currentImageWidth=this.width;b.currentImageHeight=this.height;b.unzoomedImage.src=this.src;if(b.currentTooWide&&!this.currentTooTall){b.unzoomedImage.style.marginTop=(b.previewPaneHeight-b.unzoomedImage.height)/2+"px"}};a.src=this.images[this.currentImageIndex].fullsize.url};QSC.apps.product.imageZoomPopup.prototype.open=function(c){for(var a=0,b=this.images.length;a<b;a++){if(this.images[a].thumbnail.url===c||this.images[a].preview.url===c||this.images[a].fullsize.url===c){this.cycleToImage(a);break}}QSC.apps.product.imageZoomPopup.superclass.open.call(this)};QSC.apps.product.imageZoomPopup.prototype.centerLargeImage=function(c){var h=QSC.util.events.getPageXY(c||event);var g=$(this.largeImage).offset();var f=parseInt(((h.x-g.left)*this.currentImageWidth)/this.previewPaneWidth);var a=parseInt(((h.y-g.top)*this.currentImageHeight)/this.previewPaneHeight);var d="center";var b="center";if(this.currentTooWide){d=[Math.max(-this.currentImageWidth+this.previewPaneWidth,Math.min(0,-f+(this.previewPaneWidth/2))),"px "].join("")}if(this.currentTooTall){b=[Math.max(-this.currentImageHeight+this.previewPaneHeight,Math.min(0,-a+(this.previewPaneHeight/2))),"px"].join("")}this.largeImage.style.backgroundPosition=d+" "+b};QSC.apps.product.imageZoomPopup.prototype.showNextImage=function(){this.cycleToImage(this.currentImageIndex+1)};QSC.apps.product.imageZoomPopup.prototype.showPreviousImage=function(){this.cycleToImage(this.currentImageIndex-1)};QSC.apps.product.imageZoomPopup.prototype.zoomOut=function(){if(this.currentTooWide||this.currentTooTall){this.unzoomedImage.style.display="";this.largeImage.style.visibility="hidden"}};QSC.apps.product.imageZoomPopup.prototype.zoomIn=function(){this.unzoomedImage.style.display="none";this.largeImage.style.visibility="visible"};QSC.apps.product.imageZoomPopup.prototype.escapeUrl=function(a){return a.replace(/"/g,"%22")};QSC.apps.product.imageZoomPopup.prototype.initModal=function(){var e=this;var j=QSC.util.createEl("div",{className:"qsc-image-zoom-popup"});var f=QSC.util.createEl("div",{className:"top-row",innerHTML:"<div style='padding-top:8px'></div>"});var a=QSC.util.createEl("div",{className:"btn-close",onclick:function(){e.close()},title:"Close Zoom"});f.firstChild.appendChild(a);j.appendChild(f);var g=QSC.util.createEl("div",{className:"middle-row clearfix"});var c=QSC.util.createEl("div",{className:"btn-previous-image",innerHTML:"<div title='Previous Image'></div>",onclick:function(){e.showPreviousImage()}});var h=QSC.util.createEl("div",{className:"btn-next-image",innerHTML:"<div title='Next Image'></div>",onclick:function(){e.showNextImage()}});this.largeImage=QSC.util.createEl("div",{className:"large-image",onmousemove:function(i){e.centerLargeImage(i)},onclick:function(){e.zoomOut()}});this.unzoomedImage=QSC.util.createEl("img",{className:"unzoomed-image",onclick:function(i){var i=QSC.util.events.getEvent(i);e.centerLargeImage(i);e.zoomIn();i.stopPropagation();return false}});this.largeImage.appendChild(this.unzoomedImage);g.appendChild(c);g.appendChild(this.largeImage);g.appendChild(h);j.appendChild(g);this.bottomRow=QSC.util.createEl("div",{className:"bottom-row"});for(var d=0,b=this.images.length;d<b;d++){this.bottomRow.appendChild(QSC.util.createEl("span",{id:d+"zoom-image-thumbnail",onclick:function(){e.cycleToImage(parseInt(this.id))},onmouseover:function(){QSC.util.addClass(this,"hovered-image")},onmouseout:function(){QSC.util.removeClass(this,"hovered-image")},style:{backgroundImage:'url("'+this.escapeUrl(this.images[d].thumbnail.url)+'")'}}))}if(this.images.length===1){c.style.visibility="hidden";h.style.visibility="hidden";this.bottomRow.style.display="none"}j.appendChild(this.bottomRow);this.config.modalEl=j;QSC.apps.product.imageZoomPopup.superclass.initModal.call(this)};
QSC.util.namespace("QSC.ui");QSC.ui.carousel=function(a){QSC.util.loadClassConfig(this,a,{containerEl:null});this.init()};QSC.ui.carousel.instances={};QSC.ui.carousel.prototype.init=function(){this.aPages=$(".carousel-page",this.config.containerEl);this.eBody=$(".carousel-body:first",this.config.containerEl)[0];this.eBtnNext=$(".next-button:first",this.config.containerEl)[0];this.eBtnPrev=$(".prev-button:first",this.config.containerEl)[0];this.iNumPages=this.aPages.length;this.iCurPage=0};QSC.ui.carousel.prototype.scrollRight=function(){if(!QSC.util.hasClass(this.eBtnNext,"disabled")){if(this.iCurPage+1>=this.iNumPages){this.eBody.appendChild(this.aPages[0]);this.aPages=$(".carousel-page",this.eBody);this.eBody.scrollLeft=0;this.eBody.scrollLeft=$(this.aPages[--this.iCurPage]).position().left}if(this.iCurPage+1<this.iNumPages){$(this.eBody).animate({scrollLeft:this.eBody.scrollLeft+$(this.aPages[++this.iCurPage]).position().left})}}};QSC.ui.carousel.prototype.scrollLeft=function(){if(!QSC.util.hasClass(this.eBtnPrev,"disabled")){if(this.iCurPage===0){this.eBody.appendChild(this.aPages[0]);this.aPages=$(".carousel-page",this.config.containerEl);this.eBody.scrollLeft=$(this.aPages[this.iNumPages-1]).position().left;this.iCurPage=this.iNumPages-1}if(this.iCurPage-1>=0){$(this.eBody).animate({scrollLeft:this.eBody.scrollLeft+$(this.aPages[--this.iCurPage]).position().left})}}};QSC.ui.carousel.get=function(a){if(a in QSC.ui.carousel.instances){return QSC.ui.carousel.instances[a]}else{return QSC.ui.carousel.instances[a]=new QSC.ui.carousel({containerEl:document.getElementById(a)})}};
var QSC=QSC||{};QSC.ui=QSC.ui||{};QSC.ui.button=function(a){QSC.util.loadClassConfig(this,a,{containerEl:document.body,className:"",autoShow:true,autoRender:true,type:QSC.ui.button.types.INPUT,onclick:function(d,c){},text:"",ci:null,baseClass:"qsc-button",href:"javascript:void(0)"});this.isRendered=false;this.isShown=false;this.isDisabled=false;this.buttonEl=null;this.containerEl=null;var b=this;QSC.util.events.onDOMReady(function(){b.init()})};QSC.ui.button.types={TEXT:"text",INPUT:"button",SUBMIT:"submit"};QSC.ui.button.types.impl={PRIMARY:"primary",SECONDARY:"secondary"};QSC.ui.button.types.def={OK:"ok",SUBMIT:"submit",CANCEL:"cancel"};QSC.ui.button.prototype.init=function(){if(!this.config.autoRender){return}this.render();this[this.config.autoShow?"show":"hide"]()};QSC.ui.button.prototype.initTypeConfig=function(){switch(this.config.type){case QSC.ui.button.types.def.OK:this.config.type=QSC.ui.button.types.impl.PRIMARY;this.config.text=this.config.text||"OK";break;case QSC.ui.button.types.def.SUBMIT:this.config.type=QSC.ui.button.types.impl.PRIMARY;this.config.text=this.config.text||"SUBMIT";break;case QSC.ui.button.types.def.CANCEL:this.config.type=QSC.ui.button.types.TEXT;this.config.text=this.config.text||"Cancel";break}switch(this.config.type){case QSC.ui.button.types.impl.PRIMARY:this.config.type=QSC.ui.button.types.INPUT;this.config.className=[this.config.className,"qsc-button-type-impl-primary"].join(" ");break;case QSC.ui.button.types.impl.SECONDARY:this.config.type=QSC.ui.button.types.INPUT;this.config.className=[this.config.className,"qsc-button-type-impl-secondary"].join(" ");break}};QSC.ui.button.prototype.render=function(){var g=this,c="";this.initTypeConfig();switch(this.config.type){case QSC.ui.button.types.TEXT:var e=document.createElement("a");e.href=this.config.href;QSC.util.setText(e,this.config.text);c="qsc-button-type-text";break;case QSC.ui.button.types.INPUT:case QSC.ui.button.types.SUBMIT:var e=document.createElement("a");e.href="javascript:void(0)";var f=document.createElement("span");f.className="button-left";e.appendChild(f);var d=document.createElement("span");d.className="button-right";f.appendChild(d);var a=document.createElement("input");a.className="button-center";a.type=this.config.type;a.value=this.config.text;d.appendChild(a);c="qsc-button-type-input";break;default:throw ("Button type '"+this.config.type+"' does not exist");return;break}QSC.util.events.addEvent(e,"click",this.onclick,this,e);if(this.config.ci!=null){QSC.util.events.addEvent(e,"click",function(h){FBTS.record({e:h,ci:g.config.ci})})}e.className=[this.config.baseClass,c,this.config.className].join(" ");this.buttonEl=document.createElement("span");this.buttonEl.className="qsc-button-container hidden";this.buttonEl.appendChild(e);var b=this.containerEl=QSC.util.getElement(this.config.containerEl);b.appendChild(this.buttonEl);this.isRendered=true};QSC.ui.button.prototype.show=function(){if(!this.isRendered){throw ("Cannot show the button until it is rendered");return}QSC.util.removeClass(this.buttonEl,"hidden");this.isShown=true};QSC.ui.button.prototype.hide=function(){if(!this.isRendered){throw ("Cannot hide the button until it is rendered");return}QSC.util.addClass(this.buttonEl,"hidden");this.isShown=false};QSC.ui.button.prototype.onclick=function(b,a){if(this.isDisabled){if(b.preventDefault){b.preventDefault()}b.returnValue=false;return false}else{return this.config.onclick.apply(a,[b,this])}};QSC.ui.button.prototype.setEnabled=function(a){if(!this.isRendered){throw ("Cannot enable/disable the button until it is rendered");return}this.isDisabled=!a;if(a){QSC.util.removeClass(this.buttonEl,"disabled")}else{QSC.util.addClass(this.buttonEl,"disabled")}};QSC.util.namespace("QSC.ui.button.util");QSC.ui.button.util.toggleButton=function(c){QSC.util.toggleClass(c,"button-toggle-on");QSC.util.toggleClass(c,"button-toggle-off");var a=document.createTextNode(" "),b=$(".button-center",c)[0];b.appendChild(a);b.removeChild(a)};QSC.ui.button.util.isToggleButtonOn=function(a){return QSC.util.hasClass(a,"button-toggle-on")};
var QSC=QSC||{};QSC.ui=QSC.ui||{};QSC.ui.popup.dialog=function(a){QSC.util.loadClassConfig(this,a,{noHeader:false,noFooter:false,elementId:"",headerContent:"",bodyContent:"",disableCloseButton:false,disableHeaderIcon:true,buttons:{},onCancel:function(){}});this.headerEl=null;this.bodyEl=null;this.footerEl=null;this.elementIdEl=null;this.footerAlignerEl=null;this.buttons={};QSC.ui.popup.dialog.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.ui.popup.dialog,QSC.ui.popup);QSC.ui.popup.dialog.prototype.initModal=function(){var a=this.config.modalEl=document.createElement("div");a.className="qsc-popup-dialog";if(this.config.elementId!=""){a.id=this.config.elementId}this.createHeader(a);this.createBody(a);this.createFooter(a);QSC.ui.popup.dialog.superclass.initModal.call(this)};QSC.ui.popup.dialog.prototype.cancel=function(){if(this.config.onCancel.apply(this)!==false){this.close()}};QSC.ui.popup.dialog.prototype.createHeader=function(a){var b=this;if(this.config.noHeader){return}this.headerEl=document.createElement("div");this.headerEl.className="header";this.setHeader(this.config.headerContent);if(!this.config.disableCloseButton){this.headerCloseButton=QSC.util.createEl("div",{className:"close-button",title:"Close Dialog",onclick:function(){b.cancel()}});a.appendChild(this.headerCloseButton)}if(!this.config.disableHeaderIcon){this.headerIcon=QSC.util.createEl("div",{className:"header-icon"});a.appendChild(this.headerIcon)}a.appendChild(this.headerEl)};QSC.ui.popup.dialog.prototype.createBody=function(a){this.bodyEl=document.createElement("div");this.bodyEl.className="body";this.setBody(this.config.bodyContent);a.appendChild(this.bodyEl)};QSC.ui.popup.dialog.prototype.setHeader=function(a){this.headerEl.innerHTML=a};QSC.ui.popup.dialog.prototype.getHeader=function(){return this.headerEl.innerHTML};QSC.ui.popup.dialog.prototype.setBody=function(a){this.bodyEl.innerHTML="";if(a.nodeType){this.bodyEl.appendChild(a);a.style.display="block";a.style.visibility="visible"}else{if(document.getElementById("ui-dialog-"+a)){this.bodyEl.id=a;a=document.getElementById("ui-dialog-"+a);this.bodyEl.innerHTML=a.textContent||a.innerHTML}else{this.bodyEl.innerHTML=a}}};QSC.ui.popup.dialog.prototype.createFooter=function(a){if(this.config.noFooter){return}var e=this.footerEl=document.createElement("div");e.className="footer";var d=this.footerAlignerEl=document.createElement("div");d.className="aligner";e.appendChild(d);for(var c in this.config.buttons){var b=this.config.buttons[c];this.createFooterButton(c,b)}a.appendChild(e)};QSC.ui.popup.dialog.prototype.getFooter=function(){return this.footerEl};QSC.ui.popup.dialog.prototype.getButton=function(a){return this.buttons[a]};QSC.ui.popup.dialog.prototype.createFooterButton=function(b,a){a.containerEl=this.footerAlignerEl;this.buttons[b]=new QSC.ui.button(a)};QSC.ui.popup.dialog.prototype.destroy=function(){var a=this.config.bodyContent;QSC.ui.popup.dialog.superclass.destroy.call(this);if(a.nodeType){a.style.display="none";document.body.appendChild(a)}delete this.headerEl;delete this.bodyEl;delete this.footerEl;delete this.footerAlignerEl;delete this.buttons};QSC.ui.popup.dialog.prototype.positionContent=function(){with(this.modalEl.style){height=width="auto"}with(this.bodyEl.style){height=width="auto";overflow="auto"}var modalEl=$(this.modalEl),width=modalEl.width(),height=modalEl.height(),windowjQ=$(window),windowWidth=windowjQ.width(),windowHeight=windowjQ.height(),padding=20,bodyEl=$(this.bodyEl);if((height+padding)>windowHeight){var headerHeight=$(this.headerEl).outerHeight()||0,footerHeight=$(this.footerEl).outerHeight()||0;bodyEl.width(bodyEl.width());bodyEl.height(Math.max(0,windowHeight-padding-headerHeight-footerHeight-(bodyEl.outerHeight()-bodyEl.height())));this.bodyEl.style.overflow="auto"}if((width+padding)>windowWidth){this.modalEl.style.width=windowWidth-padding+"px";bodyEl.width(Math.max(0,windowWidth-padding-(bodyEl.outerWidth()-bodyEl.width())));this.bodyEl.style.overflow="auto"}if(modalEl.css("position")==="fixed"){this.modalEl.style.top=Math.max(padding/2,parseInt(windowHeight/2-height/2))+"px";this.modalEl.style.left=Math.max(padding/2,parseInt(windowWidth/2-width/2))+"px"}};
var QSC=QSC||{};QSC.apps=QSC.apps||{};QSC.apps.inlineNotification=function(a){QSC.util.loadClassConfig(this,a,{container:"user-information-feedback",containerClass:"notification-container",iconMap:{info:"info-icon",success:"success-icon",error:"error-icon",warning:"warning-icon",loading:"loading-icon"},disableClose:false,allowMultiple:false,autoScroll:true,autoRender:true,autoShow:true,iconType:"",titleHTML:"",bodyHTML:"",feedbackJSON:null});this.aFieldFeedbackElements=[];if(typeof(this.config.container)=="string"&&this.config.container.substr(0,1)!="#"){this.config.container="#"+this.config.container}var b=this;if(this.config.autoRender){$(function(){b.render()})}if(this.config.autoShow){$(function(){b.show()})}};QSC.apps.inlineNotification.defaultTitle={ERROR:"The following error(s) require attention before continuing:",WARNING:"The following may require your attention:",SUCCESS:"Operation Completed Successfully!",INFO:"Important Information"};QSC.apps.inlineNotification.prototype.render=function(){var h=this;var a=QSC.util.createEl("div",{className:"notification-container clear-fix",style:{opacity:0,display:"none"}});if(!this.config.disableClose){var f=QSC.util.createEl("div",{className:"notification-close"});var i=QSC.util.createEl("div",{className:"notification-close-icon",onclick:function(){h.hide()}});f.appendChild(i);a.appendChild(f)}var e=QSC.util.createEl("div",{className:"notification-icon-col"});var b=QSC.util.createEl("div",{className:"notification-icon"});e.appendChild(b);a.appendChild(e);var c=QSC.util.createEl("div",{className:"notification-text"});var d=QSC.util.createEl("div",{className:"notification-title-text"});var g=QSC.util.createEl("div",{className:"notification-body-text"});this.body=$(a);this.titleText=$(d);this.setTitleHTML(this.config.titleHTML);this.bodyText=$(g);this.setBodyHTML(this.config.bodyHTML);this.setIconType(this.config.iconType);c.appendChild(d);c.appendChild(g);a.appendChild(c);this.container=$(this.config.container);if(this.config.allowMultiple){this.container.append(this.body)}else{this.container.html(this.body)}if(this.config.feedbackJSON){this.updateFromJSON(this.config.feedbackJSON,true)}};QSC.apps.inlineNotification.prototype.showFieldFeedback=function(a){a=a||this.config.feedbackJSON;this.clearFieldFeedback();var e=a.fieldFeedback;for(var b=0,c=e.length;b<c;b++){var d=this.getFieldFeedbackElement(e[b]);if(d!==null){this.updateFieldFeedbackElement(d,this.formatMessagesFromJSON(e[b].warning.messages))}}};QSC.apps.inlineNotification.prototype.updateFieldFeedbackElement=function(a,c){var b=null;if(a.type&&a.type==="checkbox"){if(!QSC.util.hasClass(a.parentNode.nextSibling,"notification-field-feedback")){b=QSC.util.insertAfter(QSC.util.createEl("div",{className:"notification-field-feedback"}),a.parentNode)}else{b=a.parentNode.nextSibling}}else{if(a.tagName.toUpperCase()==="DIV"){if(!QSC.util.hasClass(a,"notification-field-feedback")){QSC.util.addClass(a,"notification-field-feedback")}b=a}else{if(!QSC.util.hasClass(a.nextSibling,"notification-field-feedback")){b=QSC.util.insertAfter(QSC.util.createEl("div",{className:"notification-field-feedback"}),a)}else{b=a.nextSibling}}}b.innerHTML=c;this.aFieldFeedbackElements.push(b)};QSC.apps.inlineNotification.prototype.clearFieldFeedback=function(){while(this.aFieldFeedbackElements.length){this.aFieldFeedbackElements.pop().innerHTML=""}};QSC.apps.inlineNotification.prototype.getFieldFeedbackElement=function(b){var a=null;if(b.formName!==""&&b.fieldName!==""){if(typeof document[b.formName]!=="undefined"&&typeof document[b.formName].elements[b.fieldName]!=="undefined"){a=document[b.formName].elements[b.fieldName]}else{a=document.getElementById(b.formName+"."+b.fieldName)}}return a};QSC.apps.inlineNotification.feedbackContainsError=function(a){return typeof a.error!=="undefined"};QSC.apps.inlineNotification.feedbackContainsWarning=function(a){return typeof a.warning!="undefined"};QSC.apps.inlineNotification.feedbackContainsFieldFeedback=function(a){return typeof a.fieldFeedback!="undefined"};QSC.apps.inlineNotification.prototype.setTitleHTML=function(a){this.titleText.html(a)};QSC.apps.inlineNotification.prototype.setIconType=function(a){this.body[0].className="notification-container "+a+"-feedback clear-fix"};QSC.apps.inlineNotification.prototype.setBodyHTML=function(a){if(a!=null&&a!=""){this.bodyText.addClass("notification-body-text")}else{this.bodyText.removeClass("notification-body-text")}this.bodyText.html(a)};QSC.apps.inlineNotification.prototype.show=function(){this.body.show();this.body.fadeTo(350,1);this.autoScroll()};QSC.apps.inlineNotification.prototype.hide=function(a){if(a){this.body.hide()}else{this.body.slideUp(150)}};QSC.apps.inlineNotification.prototype.destroy=function(){var a=this;this.body.slideUp(150,function(){a.body.remove()})};QSC.apps.inlineNotification.prototype.autoScroll=function(){if(!this.config.autoScroll){return}var c=this.body.position().top,a=Math.max(document.body.scrollTop,document.documentElement.scrollTop),b=a+$(window).height();if(c<a||c>b){window.scroll(Math.max(document.body.scrollLeft,document.documentElement.scrollLeft),c)}};QSC.apps.inlineNotification.prototype.updateFromJSON=function(f,c){var d=f.error||f.warning||f.success||f.info,c=c||false;if(!d){return}var b=d.type,e=d.title,a=this.formatMessagesFromJSON(d.messages);if(!b||!e){return}this.setIconType(b);this.setTitleHTML(e);this.setBodyHTML(a);if(!c){this.show()}};QSC.apps.inlineNotification.prototype.formatMessagesFromJSON=function(c){if(!c||!c.length){return""}var d=[];d.push("<ul>");for(var b=0,a=c.length;b<a;b++){d.push("<li>");d.push(c[b].message);d.push(this.formatMessagesFromJSON(c[b].messages));d.push("</li>")}d.push("</ul>");return d.join("")};QSC.apps.inlineNotification.fromURL=function(a){QSC.util.loadClassConfig(this,a,{type:"json",loadingTitle:"Loading...",connectionErrorTitle:"Problem connecting, please try again.",connectionErrorMessages:[{message:"If this problem persists please contact customer support"}],connectionCfg:{},notificationCfg:{},onConnectionError:function(){},onSuccess:function(){},onWarning:function(){},onError:function(){},successTitle:null,warningTitle:null,errorTitle:null});this._notification=null;this.init()};QSC.apps.inlineNotification.fromURL.prototype.init=function(){this.displayLoadingMessage();this.loadURL()};QSC.apps.inlineNotification.fromURL.prototype.displayLoadingMessage=function(){this.displayNotification("loading",this.config.loadingTitle,[])};QSC.apps.inlineNotification.fromURL.prototype.loadURL=function(){var a=this;this.config.connectionCfg.error=function(){a.connectionError.apply(a,arguments)};this.config.connectionCfg.success=function(){a.connectionSuccess.apply(a,arguments)};this.config.connectionCfg.dataType="json";$.ajax(this.config.connectionCfg)};QSC.apps.inlineNotification.fromURL.prototype.connectionError=function(){this._preventPostNotification=false;this.config.onConnectionError.apply(this,arguments);if(!this._preventPostNotification){this.displayNotification("error",this.config.connectionErrorTitle,this.config.connectionErrorMessages)}};QSC.apps.inlineNotification.fromURL.prototype.connectionSuccess=function(f){var b,d,g,a=f.feedback.error||f.feedback.warning||f.feedback.success||f.feedback.info;try{b=a.type;d=a.title;g=a.messages;var c=this.config[b+"Title"];if(c!=null){d=c}}catch(h){b="error";d=this.config.connectionErrorTitle;g=this.config.connectionErrorMessages}this._preventPostNotification=false;switch(b){case"success":this.config.onSuccess.apply(this,arguments);break;case"warning":this.config.onWarning.apply(this,arguments);break;case"error":this.config.onError.apply(this,arguments);break}if(!this._preventPostNotification){this.displayNotification(b,d,g)}};QSC.apps.inlineNotification.fromURL.prototype.preventPostNotification=function(){this._preventPostNotification=true};QSC.apps.inlineNotification.fromURL.prototype.getNotification=function(){return this._notification};QSC.apps.inlineNotification.fromURL.prototype.displayNotification=function(c,e,g){var b;if(g.length){var f=[];for(var d=0,a=g.length;d<a;d++){f.push(g[d].message)}b="<ul><li>"+f.join("</li><li>")+"</li></ul>"}this.config.notificationCfg.iconType=c;this.config.notificationCfg.titleHTML=e;this.config.notificationCfg.bodyHTML=b;this._notification=new QSC.apps.inlineNotification(this.config.notificationCfg)};
QSC.util.namespace("QSC.ui.popup.dialog");QSC.ui.popup.dialog.form=function(d){var c=this;this.config=d;var b=d.submitType;var a=d.cancelType;if(b==null){b=QSC.ui.button.types.def.OK}if(a==null){a=QSC.ui.button.types.def.CANCEL}this.notification=null;QSC.util.loadClassConfig(this,d,{saveInBackground:true,saveFormNotificationTitle:"Saving",buttons:{Ok:{type:b,onclick:function(f){c.saveForm();if(f.preventDefault){f.preventDefault()}f.returnValue=false;return false}},Cancel:{type:a,onclick:function(f){c.cancel();if(f.preventDefault){f.preventDefault()}f.returnValue=false;return false}}}});QSC.ui.popup.dialog.form.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.ui.popup.dialog.form,QSC.ui.popup.dialog);QSC.ui.popup.dialog.form.prototype.init=function(){var a=this;this.notificationContainer=QSC.util.createEl("div");QSC.ui.popup.dialog.form.superclass.init.call(this);if(this.config.formContent==undefined){this.config.formContent=this.bodyEl.getElementsByTagName("FORM")[0]}$(this.getForm()).bind("submit",function(){a.saveForm();return false});this.bodyEl.firstChild.insertBefore(this.notificationContainer,this.bodyEl.firstChild.firstChild);this.notification=new QSC.apps.inlineNotification({container:this.notificationContainer,disableClose:true,autoShow:false,autoScroll:false});if(this.config.formDataUrl!=null){$.ajax({type:"GET",url:this.config.formDataUrl,cache:false,dataType:"json",success:function(b){a.onFormDataLoad(b)},error:function(){a.errorLoadingData=true;a.onUnknownError()}});if(this.config.onFormDataLoad instanceof Function){this.getForm().style.visibility="hidden";this.updateNotification({iconType:"loading",titleHTML:"Loading..."})}}else{this.onFormDataLoad()}};QSC.ui.popup.dialog.form.prototype.onFormDataLoad=function(a){if(this.config.onFormDataLoad instanceof Function){this.config.onFormDataLoad.call(this,a)}this.getForm().style.visibility="visible";this.notification.hide()};QSC.ui.popup.dialog.form.prototype.updateNotification=function(a){this.notification.show();if(a.iconType!=undefined){this.notification.setIconType(a.iconType)}if(a.titleHTML!=undefined){this.notification.setTitleHTML(a.titleHTML)}if(a.bodyHTML!=undefined){this.notification.setBodyHTML(a.bodyHTML)}else{this.notification.setBodyHTML("")}this.positionContent()};QSC.ui.popup.dialog.form.prototype.onUnknownError=function(){this.updateNotification({iconType:"error",titleHTML:"Error Processing Request",bodyHTML:"Please Try Again"});if(this.config.onUnknownError instanceof Function){this.config.onUnknownError()}};QSC.ui.popup.dialog.form.prototype.saveForm=function(){var a=this;if(this.errorLoadingData){this.close();return}if(this.getForm().onsubmit instanceof Function){if(!this.getForm().onsubmit()){return false}}if(this.config.onBeforeSave instanceof Function){var b=this.config.onBeforeSave.call(this);if(b===false){return false}}this.updateNotification({iconType:"loading",titleHTML:this.config.saveFormNotificationTitle});if(this.config.saveInBackground){$.ajax({type:"POST",url:this.getForm().action,cache:false,data:$(this.getForm()).serialize(),dataType:"json",success:function(c){try{var f=a.config.onSave.call(a,c);if(f){a.close()}}catch(d){a.onUnknownError()}},error:function(){a.onUnknownError()}})}else{this.getForm().submit()}};QSC.ui.popup.dialog.form.prototype.getNotification=function(){return this.notification};QSC.ui.popup.dialog.form.prototype.getForm=function(){return this.config.formContent};QSC.ui.popup.dialog.form.prototype.destroy=function(){this.bodyEl.firstChild.removeChild(this.notificationContainer);QSC.ui.popup.dialog.form.superclass.destroy.call(this)};
var QSC=QSC||{};QSC.apps=QSC.apps||{};QSC.apps.charLimitCountdown=function(a){QSC.util.loadClassConfig(this,a,{charLimit:2000});this.feedbackEl=null;this.sourceEl=null;var b=this;$(function(){b.init()})};QSC.apps.charLimitCountdown.prototype.init=function(){this.retrieveElements();this.attachEvents();this.updateCountdown()};QSC.apps.charLimitCountdown.prototype.retrieveElements=function(){this.feedbackEl=QSC.util.getElement(this.config.feedbackEl);this.sourceEl=QSC.util.getElement(this.config.sourceEl);if(!this.feedbackEl){throw ("Feedback Element not found")}if(!this.sourceEl){throw ("Source Element not found")}};QSC.apps.charLimitCountdown.prototype.attachEvents=function(){var a=this;$(this.sourceEl).bind("change click blur keyup focus",null,function(){a.updateCountdown()})};QSC.apps.charLimitCountdown.prototype.getLength=function(){return this.sourceEl.value.replace(/\r(?!\n)/g,"\r\n").replace(/(\r)?\n/g,function(d,c){return c?d:"\r\n"}).length};QSC.apps.charLimitCountdown.prototype.updateCountdown=function(){var a=(this.config.charLimit-this.getLength());if(a<0){a="("+a+")"}QSC.util.setText(this.feedbackEl,a)};
QSC.util.namespace("QSC.ui");QSC.ui.contentPagination=function(a){QSC.util.loadClassConfig(this,a,{pagination:null,containerEl:null,onPageChange:function(){}})};QSC.ui.contentPagination.prototype.setContainer=function(a){this.config.containerEl=a};QSC.ui.contentPagination.prototype.setPagination=function(a){this.config.pagination=a};QSC.ui.contentPagination.prototype.getPageLink=function(a,b,c){var d=this;return QSC.util.createEl("a",{className:(b?"active-page":"page"),onclick:function(){d.config.onPageChange(a)},innerHTML:c})};QSC.ui.contentPagination.prototype.getDivider=function(){return QSC.util.createEl("span",{text:"..."})};QSC.ui.contentPagination.prototype.render=function(){if(!QSC.util.hasClass(this.config.containerEl,"qsc-ui-contentPagination")){QSC.util.addClass(this.config.containerEl,"qsc-ui-contentPagination")}this.config.containerEl.innerHTML="";if(this.config.pagination.numberOfAvailablePages<=7){for(var b=0;b<this.config.pagination.numberOfAvailablePages;b++){this.config.containerEl.appendChild(this.getPageLink(b,(b===this.config.pagination.page),b+1))}}else{if(this.config.pagination.page>0){this.config.containerEl.appendChild(this.getPageLink(this.config.pagination.page-1,false,"&laquo;"))}this.config.containerEl.appendChild(this.getPageLink(0,this.config.pagination.page===0,1));if(this.config.pagination.page>2){this.config.containerEl.appendChild(this.getDivider())}var a=Math.min(Math.max(this.config.pagination.page-1,1),this.config.pagination.numberOfAvailablePages-4);for(var b=a;b<=a+2;b++){this.config.containerEl.appendChild(this.getPageLink(b,this.config.pagination.page===b,b+1))}if(this.config.pagination.numberOfAvailablePages-this.config.pagination.page>3){this.config.containerEl.appendChild(this.getDivider())}this.config.containerEl.appendChild(this.getPageLink(this.config.pagination.numberOfAvailablePages-1,this.config.pagination.page===this.config.pagination.numberOfAvailablePages-1,this.config.pagination.numberOfAvailablePages));if(this.config.pagination.page<(this.config.pagination.numberOfAvailablePages-1)){this.config.containerEl.appendChild(this.getPageLink(this.config.pagination.page+1,false,"&raquo;"))}}};
QSC.util.namespace("QSC.apps.storefront.ratingsReviews");QSC.apps.storefront.ratingsReviews=function(a){QSC.util.loadClassConfig(this,a,{iProductId:null,bLoadReviews:false});this.elContainer=null;this.elDynamicContent=null;this.oSettings={iPageNumber:1,iFilterRating:null,eSortOrder:QSC.apps.storefront.ratingsReviews.SORTORDER.CREATE_DATE,bSortAscending:false};this.oNewRatingDialog=null;this.oPagination=null;var b=this;QSC.util.events.onDOMReady(function(){b.init()})};QSC.apps.storefront.ratingsReviews.SORTORDER={STATUS:1,REVIEWER_NAME:2,PRODUCT_LABEL:3,RATING:4,CREATE_DATE:5};QSC.apps.storefront.ratingsReviews.SEARCH_ERRORS={SUCCESS:"SUCCESS",ERRORVALIDATION:"ERRORVALIDATION",ERRORINACTIVE:"ERRORINACTIVE",ERRORNOPRODUCT:"ERRORNOPRODUCT"};QSC.apps.storefront.ratingsReviews.PERSIST_ERRORS={SUCCESS:"SUCCESS",ERRORVALIDATION:"ERRORVALIDATION",ERRORINACTIVE:"ERRORINACTIVE",ERRORNOPRODUCT:"ERRORNOPRODUCT",ERRORNOUSER:"ERRORNOUSER",ERRORPREVIEW:"ERRORPREVIEW"};QSC.apps.storefront.ratingsReviews.prototype.init=function(){this.elContainer=document.getElementById("productReviews");this.elDynamicContent=document.getElementById("productReviewsDynamic");if(QSC.util.hash.get("showReviews")=="true"){this.scrollToSection()}if(this.config.bLoadReviews){this.refreshReviews()}else{QSC.util.removeClass(this.elContainer,"loading")}if(QSC.util.hash.get("writeReview")=="true"){this.writeReview()}};QSC.apps.storefront.ratingsReviews.prototype.getRequestData=function(){var a={productId:this.config.iProductId,page:this.oSettings.iPageNumber,sortOrder:(this.oSettings.bSortAscending?this.oSettings.eSortOrder:-this.oSettings.eSortOrder)};if(this.oSettings.iFilterRating!=null){a.rating=this.oSettings.iFilterRating}return a};QSC.apps.storefront.ratingsReviews.prototype.refreshReviews=function(){var a=this;QSC.util.addClass(this.elContainer,"loading");$.ajax({url:"productReviewSearch.sc",data:this.getRequestData(),dataType:"json",cache:false,error:function(){a.onError.apply(a,arguments)},success:function(){a.updateResults.apply(a,arguments)}})};QSC.apps.storefront.ratingsReviews.prototype.onError=function(){QSC.util.removeClass(this.elContainer,"loading");this.elDynamicContent.innerHTML='<div class="review-error">An error occured. <a href="javascript:void(0)" onclick="QSC.page.current().getRatingsReviews().refreshReviews()">Click here to try again</a></div>'};QSC.apps.storefront.ratingsReviews.prototype.updateResults=function(a){if(a.responseStatus==QSC.apps.storefront.ratingsReviews.PERSIST_ERRORS.ERRORVALIDATION||a.responseStatus==QSC.apps.storefront.ratingsReviews.PERSIST_ERRORS.ERRORINACTIVE||a.responseStatus==QSC.apps.storefront.ratingsReviews.PERSIST_ERRORS.ERRORNOPRODUCT){this.onError();return}QSC.util.removeClass(this.elContainer,"loading");if(a.pagination.resultCount==0&&!this.hasActiveFilters(a)){this.elDynamicContent.innerHTML='<div class="review-no-results">No Reviews.  <a href="javascript:void(0)" onclick="QSC.page.current().getRatingsReviews().writeReview()">Write a review</a></div>'}else{this.elDynamicContent.innerHTML=a.sContentHTML;this.updatePagination(a.pagination)}};QSC.apps.storefront.ratingsReviews.prototype.updatePagination=function(b){if(!(b.resultCount>0)){return}if(this.oPagination==null){var d=this;this.oPagination=new QSC.ui.contentPagination({onPageChange:function(e){d.setPage(e+1)}})}b.page=b.page-1;this.oPagination.setPagination(b);var c=$("#productReviewsDynamic .review-top .review-pagination")[0],a=$("#productReviewsDynamic .review-bottom .review-pagination")[0];this.oPagination.setContainer(c);this.oPagination.render();this.oPagination.setContainer(a);this.oPagination.render()};QSC.apps.storefront.ratingsReviews.prototype.scrollToSection=function(){$(window).scrollTop(this.elContainer.offsetTop-25)};QSC.apps.storefront.ratingsReviews.prototype.setSorting=function(a,b){this.oSettings.iPageNumber=1;this.oSettings.eSortOrder=a;this.oSettings.bSortAscending=b;this.scrollToSection();this.refreshReviews()};QSC.apps.storefront.ratingsReviews.prototype.setPage=function(a){this.oSettings.iPageNumber=a;this.scrollToSection();this.refreshReviews()};QSC.apps.storefront.ratingsReviews.prototype.setRatingsFilter=function(a){this.oSettings.iPageNumber=1;this.oSettings.iFilterRating=a;this.scrollToSection();this.refreshReviews()};QSC.apps.storefront.ratingsReviews.prototype.forceLogin=function(){window.location.href="writeReview.sc?productId="+this.config.iProductId};QSC.apps.storefront.ratingsReviews.prototype.onReviewSave=function(c){if(c.responseStatus==QSC.apps.storefront.ratingsReviews.PERSIST_ERRORS.ERRORNOUSER){this.forceLogin()}if(QSC.apps.inlineNotification.feedbackContainsError(c.feedback)){this.oNewRatingDialog.getNotification().updateFromJSON(c.feedback);this.oNewRatingDialog.positionContent();return false}else{if(document.getElementById("user-information-feedback")==null){var b=$("div.main-content")[0].parentNode,a=document.createElement("div");a.id="user-information-feedback";b.insertBefore(a,b.firstChild)}var d=new QSC.apps.inlineNotification({feedbackJSON:c.feedback});return true}};QSC.apps.storefront.ratingsReviews.prototype.writeReview=function(){if(!QSC.env.isLoggedIn()){this.forceLogin();return}var c=this;var a=QSC.util.getTopMostZIndex();this.oNewRatingDialog=new QSC.ui.popup.dialog.form({bodyContent:"reviewDialog",headerContent:"Write a Review",zIndexes:{modal:a+3,mask:a+2,pageHeader:a+1},submitType:QSC.ui.button.types.def.SUBMIT,onSave:function(){return c.onReviewSave.apply(c,arguments)}});var b=new QSC.apps.charLimitCountdown({charLimit:1000,sourceEl:"reviewDialogContent",feedbackEl:"reviewDialogCountdown"})};QSC.apps.storefront.ratingsReviews.prototype.toggleRating=function(d,b){var e=d.parentNode.getElementsByTagName("div");for(var c=0,a=e.length;c<a;c++){QSC.util.removeClass(e[c],"selected")}QSC.util.addClass(d,"selected");this.oNewRatingDialog.getForm()["rating"].value=b};QSC.apps.storefront.ratingsReviews.prototype.hasActiveFilters=function(a){if(a.criteria.rating!=""){return true}return false};QSC.apps.storefront.ratingsReviews.prototype.resetFilters=function(){this.setRatingsFilter("")};
QSC.util.namespace("QSC.page.storefront");QSC.page.storefront.product=function(a){QSC.util.loadClassConfig(this,a,{iProductId:null,images:[],bHasOptions:false,options:{},bShowRatingReviews:false,bLoadReviews:false});this.zoomPopup=null;this.oOptionsHandler=null;this.oRatingReviews=null;QSC.page.storefront.product.superclass.constructor.call(this,this.config)};QSC.util.extend(QSC.page.storefront.product,QSC.page);QSC.page.storefront.product.prototype.init=function(){if(this.config.bHasOptions){this.initOptions()}if(this.config.bShowRatingReviews){this.initRatingReviews()}};QSC.page.storefront.product.prototype.initOptions=function(){this.oOptionsHandler=new QSC.apps.product.options({optionsList:this.config.options.optionsList,availMap:this.config.options.availMap,price:this.config.options.price,userPrefNoDefaultOption:this.config.options.bAutoPick})};QSC.page.storefront.product.prototype.initRatingReviews=function(){this.oRatingReviews=new QSC.apps.storefront.ratingsReviews({iProductId:this.config.iProductId,bLoadReviews:this.config.bLoadReviews})};QSC.page.storefront.product.prototype.getRatingsReviews=function(){return this.oRatingReviews};QSC.page.storefront.product.prototype.showZoomPopup=function(a){if(this.zoomPopup===null){this.zoomPopup=new QSC.apps.product.imageZoomPopup({autoOpen:false,images:this.config.images})}this.zoomPopup.open(a.getAttribute("src",2))};
